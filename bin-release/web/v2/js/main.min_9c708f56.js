var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);r.prototype=t.prototype,e.prototype=new r},GameObject=function(){function e(){this.compornent=null,this.shapes=[],this.destroyFlag=!1,e.objects.push(this)}return e.init=function(t){e.objects=[],e.display=t},e.prototype.destroy=function(){this.destroyFlag=!0},e.prototype.addDestroyMethod=function(){},e.prototype["delete"]=function(){var t=this;this.addDestroyMethod(),this.shapes&&this.compornent&&(this.shapes.forEach(function(e){t.compornent.removeChild(e),e=null}),this.shapes=[]),Util.remove(e.display,this.compornent);var r=e.objects.filter(function(e){return e.destroyFlag!==!0});e.objects=r},e.allDestroy=function(){e.objects=e.objects.filter(function(e){return e.destroy(),e["delete"](),!1})},e.update=function(){e.objects.forEach(function(e){return e.updateContent()}),e.objects=e.objects.filter(function(e){return e.destroyFlag&&e["delete"](),!e.destroyFlag}),e.transit&&(e.allDestroy(),e.transit(),e.transit=null)},e.objects=[],e}();__reflect(GameObject.prototype,"GameObject");var GameCompornent=function(e){function t(t,r,o,n){var a=e.call(this)||this;return a.setCompornent(t,r,o,n),a}return __extends(t,e),t.prototype.setCompornent=function(e,t,r,o){this.compornent=new egret.DisplayObjectContainer,this.compornent.x=e,this.compornent.y=t,this.compornent.width=r,this.compornent.height=o,GameStage.display.addChild(this.compornent)},t.prototype["delete"]=function(){var e=this;this.addDestroyMethod(),this.shapes&&this.compornent&&(this.shapes.forEach(function(t){e.compornent.removeChild(t),t=null}),this.shapes=[]),this.compornent&&Util.remove(GameStage.display,this.compornent);var t=GameObject.objects.filter(function(e){return e.destroyFlag!==!0});GameObject.objects=t},t}(GameObject);__reflect(GameCompornent.prototype,"GameCompornent");var UICompornent=function(e){function t(t,r,o,n){var a=e.call(this)||this;return a.setCompornent(t,r,o,n),a}return __extends(t,e),t.prototype.setCompornent=function(e,t,r,o){this.compornent=new egret.DisplayObjectContainer,this.compornent.x=e,this.compornent.y=t,this.compornent.width=r,this.compornent.height=o,UILayer.display.addChild(this.compornent)},t.prototype["delete"]=function(){var e=this;this.addDestroyMethod(),this.shapes&&this.compornent&&(this.shapes.forEach(function(t){e.compornent.removeChild(t),t=null}),this.shapes=[]),this.compornent&&Util.remove(UILayer.display,this.compornent);var t=GameObject.objects.filter(function(e){return e.destroyFlag!==!0});GameObject.objects=t},t.compornents=[],t}(GameObject);__reflect(UICompornent.prototype,"UICompornent");var GameOver=function(e){function t(r,o,n,a){var i=e.call(this,r,o,n,a)||this;return i.textGameOver=null,i.textScore=null,i.textColor=ColorPallet.BLACK,t.gameOverFlag=!0,i.textGameOver=Util.myText(Game.width/2,Game.height/2-50,"GAME OVER",80,1,i.textColor,!0),i.textGameOver.anchorOffsetX=i.textGameOver.width/2,i.textGameOver.anchorOffsetY=i.textGameOver.height/2,i.compornent.addChild(i.textGameOver),i.textScore=Util.myText(Game.width/2,Game.height/2+50,"LEVEL : "+GameScene.stageLevel,80,1,i.textColor,!0),i.textScore.anchorOffsetX=i.textScore.width/2,i.textScore.anchorOffsetY=i.textScore.height/2,i.compornent.addChild(i.textScore),UILayer.display.once(egret.TouchEvent.TOUCH_BEGIN,function(e){return i.tap(e)},i),i}return __extends(t,e),t.prototype.addDestroyMethod=function(){this.compornent&&this.compornent.removeChildren(),this.textGameOver=null,this.textScore=null},t.prototype.updateContent=function(){},t.prototype.tap=function(e){t.gameOverFlag=!1,GameObject.transit=Game.init,this.destroy()},t.gameOverFlag=!1,t}(UICompornent);__reflect(GameOver.prototype,"GameOver");var ColorPallet;!function(e){e[e.BULE=4577789]="BULE",e[e.WHITE=16053492]="WHITE",e[e.RED=15607136]="RED",e[e.BLACK=530475]="BLACK"}(ColorPallet||(ColorPallet={}));var Main=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){GameObject.init(this.stage),Util.init(this),Game.init(),egret.startTick(this.tickLoop,this)},t.prototype.tickLoop=function(e){return GameObject.update(),!1},t}(eui.UILayer);__reflect(Main.prototype,"Main");var Game=function(){function e(){}return e.init=function(){this.height=egret.MainContext.instance.stage.stageHeight,this.width=egret.MainContext.instance.stage.stageWidth,Mark.circleGeneratePos=[e.width/1.5,e.height/2],Mark.crossGeneratePos=[e.width/3,e.height/2],Mark.circleRadius=e.width/20,Mark.crossWidth=e.width/26,Mark.moveSpeed=2,GameOver.gameOverFlag=!1,GameScene.stageLevel=1,new GameStage,new UILayer,new Background,new Level(0,0,0,0,ColorPallet.BLACK),new Frame(e.width/12,e.height/9.5,e.width/1.2,e.height/1.2,ColorPallet.BLACK),GameScene.create(),new PushMark(0,0,e.width,e.width,ColorPallet.BLACK)},e}();__reflect(Game.prototype,"Game");var Background=function(e){function t(){var r=e.call(this,0,0,Game.width,Game.height)||this;return r.color=ColorPallet.WHITE,t.I=r,r.shapes[0]=new egret.Shape,r.shapes[0].graphics.beginFill(r.color),r.shapes[0].graphics.drawRect(0,0,Game.width,Game.height),r.shapes[0].graphics.endFill(),r.compornent.addChild(r.shapes[0]),r}return __extends(t,e),t.prototype.updateContent=function(){},t.I=null,t}(GameCompornent);__reflect(Background.prototype,"Background");var Mark=function(e){function t(r,o,n,a,i){var s=e.call(this,r,o,n,a)||this;return s.isHit=!1,s.moveVector=[],s.circle=!1,s.lineColor=i,s.length=Math.sqrt(Math.pow(n,2)+Math.pow(a,2)),s.setMoveVector(t.moveSpeed,Util.randomInt(0,359)),t.mark.push(s),s}return __extends(t,e),t.prototype.setCircleShape=function(e,t,r,o,n,a){var i=Util.setCircle(e,t,r,o,n,a);this.compornent.addChild(i),GameStage.display.addChild(this.compornent),this.shapes.push(i)},t.prototype.setCrossShape=function(e,t,r,o,n,a,i,s){var c=Util.setLine(0,o,n,a,i,s);this.compornent.addChild(c);var h=Util.setLine(0,0,n,360-a,i,s);this.compornent.addChild(h),GameStage.display.addChild(this.compornent),this.shapes.push(c),this.shapes.push(h)},t.prototype.changeShape=function(e,t,r,o){this.shapes=[],this.compornent.removeChildren();var n=Util.setCircle(0,0,e,t,r,o);this.compornent.addChild(n),this.shapes.push(n)},t.prototype.reverseShape=function(e,t,r,o,n,a,i,s){this.shapes=[],this.compornent.removeChildren();var c=Util.setLine(0,o,n,a,i,s);this.compornent.addChild(c);var h=Util.setLine(0,0,n,360-a,i,s);this.compornent.addChild(h),this.shapes.push(c),this.shapes.push(h)},t.prototype.setMoveVector=function(e,t){this.moveVector=Util.vector(e,t)},t.prototype.move=function(){this.compornent.x+=this.moveVector[0],this.compornent.y+=this.moveVector[1]},t.prototype.checkHit=function(){this.isHit&&(this.circle?this.circle?this.circle&&(this.destroy(),GameScene.catchCircle+=1,GameScene.circleNumber==GameScene.catchCircle&&(PushMark.I.compornent.scaleX=PushMark.I.compornent.scaleY=0,PushMark.I.compornent.x=PushMark.I.compornent.y=0,GameScene.stageLevel+=1,t.moveSpeed<10&&(t.moveSpeed+=.1),GameScene.circleRate>70&&(GameScene.circleRate-=.1),t.mark.forEach(function(e){e.destroy()}),GameScene.create())):GameOver.gameOverFlag||(console.log("x"+this.compornent.x+"y"+this.compornent.y),GameScene.nowGenerate||new GameOver(0,0,0,0)):this.destroy())},t.prototype.reflect=function(){(this.compornent.x<Frame.I.compornent.x||this.compornent.x>Frame.I.compornent.x+Frame.I.compornent.width)&&(this.moveVector[0]*=-1),(this.compornent.y<Frame.I.compornent.y||this.compornent.y>Frame.I.compornent.y+Frame.I.compornent.height)&&(this.moveVector[1]*=-1)},t.prototype.updateContent=function(){GameOver.gameOverFlag||(UILayer.pushFlag?this.isHit&&!this.circle&&(GameOver.gameOverFlag||GameScene.nowGenerate||(UILayer.pushFlag=!1,PushMark.I.release(),this.reverseShape(t.crossGeneratePos[0],t.crossGeneratePos[1],t.crossWidth,t.crossWidth,this.length,45,6,ColorPallet.BULE),new GameOver(0,0,0,0))):this.checkHit(),this.move(),this.reflect())},t.mark=[],t.moveSpeed=2,t}(GameCompornent);__reflect(Mark.prototype,"Mark");var Circle=function(e){function t(t,r,o,n,a){var i=e.call(this,t,r,o,n,a)||this;return i.circle=!0,i.setCircleShape(0,0,o,i.lineColor,!1,6),i}return __extends(t,e),t}(Mark);__reflect(Circle.prototype,"Circle");var Cross=function(e){function t(t,r,o,n,a){var i=e.call(this,t,r,o,n,a)||this;return i.circle=!1,i.setCrossShape(t,r,o,n,i.length,45,6,a),i}return __extends(t,e),t}(Mark);__reflect(Cross.prototype,"Cross");var PushMark=function(e){function t(r,o,n,a,i){var s=e.call(this,r,o,n,a)||this;return s.expansion=!0,t.I=s,s.adjustmentCompornent(),s.setCircleShape(s.compornent.anchorOffsetX,s.compornent.anchorOffsetY,n/2),s}return __extends(t,e),t.prototype.setCircleShape=function(e,t,r){var o=new egret.Shape;o.x=e,o.y=t,o.graphics.lineStyle(6,this.lineColor),o.graphics.drawCircle(0,0,r),this.compornent.addChild(o),GameStage.display.addChild(this.compornent),this.shapes.push(o)},t.prototype.adjustmentCompornent=function(){this.compornent.anchorOffsetX+=this.compornent.width/2,this.compornent.anchorOffsetY+=this.compornent.height/2,this.compornent.scaleX=this.compornent.scaleY=0},t.prototype.push=function(e,t){this.compornent.scaleX=this.compornent.scaleY=.13,this.compornent.x=e,this.compornent.y=t},t.prototype.move=function(e,t){this.compornent.x=e,this.compornent.y=t},t.prototype.release=function(){this.expansion=!0,this.compornent.scaleX=this.compornent.scaleY=0,this.compornent.x=this.compornent.y=0},t.prototype.switchExpansion=function(){UILayer.pushFlag&&(this.compornent.scaleX>1?this.expansion=!1:this.compornent.scaleX<.01&&(this.expansion=!0),this.expansion?this.compornent.scaleX=this.compornent.scaleY+=.01:this.compornent.scaleX=this.compornent.scaleY-=.01)},t.prototype.checkHit=function(){var e=this;UILayer.pushFlag&&Mark.mark.forEach(function(t){!GameScene.nowGenerate&&e.compornent.hitTestPoint(t.compornent.x,t.compornent.y)?t.isHit=!0:t.isHit=!1})},t.prototype.updateContent=function(){this.switchExpansion(),this.checkHit()},t.I=null,t}(GameCompornent);__reflect(PushMark.prototype,"PushMark");var FrameLine;!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.RIGHT=2]="RIGHT",e[e.LEFT=3]="LEFT"}(FrameLine||(FrameLine={}));var Frame=function(e){function t(r,o,n,a,i){var s=e.call(this,r,o,n,a)||this;return t.I=s,s.lineColor=i,s.setShape(r,o,n,a,8),s}return __extends(t,e),t.prototype.setShape=function(e,t,r,o,n){var a=new egret.Shape;a.graphics.lineStyle(n,this.lineColor),a.graphics.drawRect(0,0,r,o),this.compornent.addChild(a),GameStage.display.addChild(this.compornent),this.shapes.push(a)},t.prototype.updateContent=function(){},t.I=null,t}(GameCompornent);__reflect(Frame.prototype,"Frame");var GameScene=function(){function e(){}return e.create=function(){e.nowGenerate=!0;var t=Mark.mark.filter(function(e){return e.destroyFlag!==!0});Mark.mark=t,e.circleNumber=0,e.catchCircle=0;for(var r=0;r<e.stageLevel+10;r++){var o=Util.randomInt(0,100);if(Mark.circleGeneratePos[0]=Util.randomInt(Frame.I.compornent.x+20,Frame.I.compornent.x+Frame.I.compornent.width-20),Mark.circleGeneratePos[1]=Util.randomInt(Frame.I.compornent.y+20,Frame.I.compornent.y+Frame.I.compornent.height-20),0==r)new Circle(Mark.circleGeneratePos[0],Mark.circleGeneratePos[1],Mark.circleRadius,Mark.circleRadius,ColorPallet.BLACK),e.circleNumber+=1;else if(1==r){new Cross(Mark.crossGeneratePos[0],Mark.crossGeneratePos[1],Mark.crossWidth,Mark.crossWidth,ColorPallet.BLACK)}else if(o<=e.circleRate)new Circle(Mark.circleGeneratePos[0],Mark.circleGeneratePos[1],Mark.circleRadius,Mark.circleRadius,ColorPallet.BLACK),e.circleNumber+=1;else if(o>e.circleRate){new Cross(Mark.crossGeneratePos[0],Mark.crossGeneratePos[1],Mark.crossWidth,Mark.crossWidth,ColorPallet.BLACK)}}Mark.mark.forEach(function(e){e.circle||e.reverseShape(Mark.crossGeneratePos[0],Mark.crossGeneratePos[1],Mark.crossWidth,Mark.crossWidth,e.length,45,6,ColorPallet.BLACK)}),e.nowGenerate=!1},e.stageLevel=1,e.circleRate=60,e.circleNumber=0,e.catchCircle=0,e.nowGenerate=!1,e}();__reflect(GameScene.prototype,"GameScene");var Util=function(){function e(){}return e.init=function(e){this.height=e.stage.stageHeight,this.width=e.stage.stageWidth,this.ui=e},e.random=function(e,t){return e+Math.random()*(t-e)},e.randomInt=function(e,t){return Math.floor(e+Math.random()*(t+.999-e))},e.clamp=function(e,t,r){return t>e&&(e=t),e>r&&(e=r),e},e.color=function(e,t,r){var o=e.toFixed(0),n=t.toFixed(0),a=r.toFixed(0);o=e.toString(16),n=t.toString(16),a=r.toString(16),o=("00"+o).slice(-2),n=("00"+n).slice(-2),a=("00"+a).slice(-2);var i=parseInt("0x"+o+n+a,16);return i},e.myText=function(e,t,r,o,n,a,i){var s=new eui.Label;return s.scaleX=n,s.scaleY=n,s.bold=i,s.size=o,s.text=r,s.textColor=a,s.x=e,s.y=t,s.multiline=!0,s},e.myStrokeText=function(e,t,r,o,n,a,i,s,c){var h=new eui.Label;return h.x=e,h.y=t,h.scaleX=n,h.scaleY=n,h.textFlow=[{text:r,style:{textColor:a,size:o,fontFamily:i,strokeColor:s,stroke:c}}],h},e.saveLocalStrage=function(e,t){window.localStorage.setItem(e,t.toString())},e.loadLocalStrage=function(e,t){var r=window.localStorage.getItem(e);null==r&&(r=t.toString(),window.localStorage.setItem(e,r.toString()));var o=parseInt(r);return o},e.setRect=function(e,t,r,o,n,a){var i=new egret.Shape;return i.x=e,i.y=t,i.graphics.beginFill(n),i.graphics.drawRoundRect(0,0,r,o,a),i.graphics.endFill(),i},e.setCircle=function(e,t,r,o,n,a){var i=r/2,s=new egret.Shape;return s.x=e,s.y=t,n?(s.graphics.beginFill(o),s.graphics.drawCircle(0,0,i),s.graphics.endFill()):(s.graphics.lineStyle(a,o),s.graphics.drawCircle(0,0,i)),s},e.setLine=function(e,t,r,o,n,a){var i=(360-o)*Math.PI/180,s=new egret.Shape;return s.x=e,s.y=t,s.graphics.lineStyle(n,a),s.graphics.moveTo(0,0),s.graphics.lineTo(r*Math.cos(i),r*Math.sin(i)),s},e.remove=function(e,t){e&&e.removeChild(t),t=null},e.vector=function(e,t,r,o){var n=(360-t)*Math.PI/180,a=[];return void 0==r&&void 0==o?(a[0]=e*Math.cos(n),a[1]=e*Math.sin(n)):(a[0]=e*Math.cos(n)-r,a[1]=e*Math.sin(n)-o),a[2]=e,a},e.cross=function(e,t){var r=e[0]*t[1]-e[1]*t[0];return r},e.dot=function(e,t){var r=e[0]*t[0]+e[1]*t[1];return r},e.cos=function(t,r){var o=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)),n=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2));0>o&&(o*=-1),0>n&&(n*=-1);var a=e.dot(t,r)/(o*n);return a},e.sin=function(t,r){var o=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)),n=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2));0>o&&(o*=-1),0>n&&(n*=-1);var a=e.cross(t,r)/(o*n);return a},e.size=function(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return t},e.reflectionVector=function(t,r,o){var n=e.cos(t,r),a=e.sin(t,r),i=[];switch(o){case FrameLine.RIGHT:i[0]=-t[0]*n,i[1]=0,i[2]=Math.abs(t[2]*n);break;case FrameLine.LEFT:i[0]=t[0]*n,i[1]=0,i[2]=Math.abs(t[2]*n);break;case FrameLine.UP:i[0]=0,i[1]=t[1]*a,i[2]=Math.abs(t[2]*a);break;case FrameLine.DOWN:i[0]=0,i[1]=-t[1]*a,i[2]=Math.abs(t[2]*a)}for(var s=[],c=0;1>=c;c++)s[c]=t[c]-2*i[c];return s},e}();__reflect(Util.prototype,"Util");var GameStage=function(){function e(){this.setContainer(),e.index=GameObject.display.getChildIndex(e.display)}return e.prototype.setContainer=function(){e.display=new egret.DisplayObjectContainer,GameObject.display.addChild(e.display)},e.prototype.addDestroyMethod=function(){e.display&&(e.display.removeChildren(),GameObject.display.removeChild(e.display),e.display=null)},e.prototype.updateContent=function(){},e.display=null,e}();__reflect(GameStage.prototype,"GameStage");var Level=function(e){function t(r,o,n,a,i){var s=e.call(this,r,o,n,a)||this;return s.score=0,s.bestScore=0,s.text=null,s.textBest=null,s.textColor=65339,s.textColor=i,t.I=s,s.score=GameScene.stageLevel,s.text=Util.myText(0,0,"LEVEL : 0",100,.5,s.textColor,!0),s.compornent.addChild(s.text),s.bestScore=Util.loadLocalStrage("Level.I.bestScore",t.I.bestScore),s.textBest=Util.myText(0,50,"BEST : "+s.bestScore.toString(),100,.5,s.textColor,!0),s.compornent.addChild(s.textBest),s}return __extends(t,e),t.prototype.addDestroyMethod=function(){this.compornent.removeChild(this.text),this.text=null,this.compornent.removeChild(this.textBest),this.textBest=null},t.prototype.updateContent=function(){this.text.text="LEVEL : "+GameScene.stageLevel.toFixed(),this.bestScore<GameScene.stageLevel&&(this.bestScore=GameScene.stageLevel,this.textBest.text="BEST : "+this.bestScore.toFixed(),Util.saveLocalStrage("Level.I.bestScore",GameScene.stageLevel))},t.prototype.addScore=function(){this.score+=1},t.I=null,t}(UICompornent);__reflect(Level.prototype,"Level");var UILayer=function(){function e(){this.setContainer(),e.index=GameObject.display.getChildIndex(e.display),e.display.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.push,this),e.display.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.move,this),e.display.addEventListener(egret.TouchEvent.TOUCH_END,this.push,this),e.display.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.out,this)}return e.prototype.setContainer=function(){e.display=new eui.UILayer,GameObject.display.addChild(e.display)},e.prototype.push=function(t){GameOver.gameOverFlag||(t.touchDown?(e.pushFlag=!0,PushMark.I.push(t.stageX,t.stageY)):(e.pushFlag=!1,PushMark.I.release()))},e.prototype.move=function(t){GameOver.gameOverFlag||(t.touchDown?(e.pushFlag=!0,PushMark.I.move(t.stageX,t.stageY)):(e.pushFlag=!1,PushMark.I.release()))},e.prototype.out=function(t){GameOver.gameOverFlag||(e.pushFlag=!1)},e.prototype.addDestroyMethod=function(){e.display&&(e.display.removeChildren(),e.display.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.push,this),e.display.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.move,this),e.display.removeEventListener(egret.TouchEvent.TOUCH_END,this.push,this),e.display.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.push,this),GameObject.display.removeChild(e.display),e.display=null)},e.prototype.updateContent=function(){},e.display=null,e.pushFlag=!1,e}();__reflect(UILayer.prototype,"UILayer");